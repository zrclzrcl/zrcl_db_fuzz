-- 创建测试表和必要结构
CREATE TABLE test_table (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    age INT CHECK (age >= 0),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    is_active BOOLEAN DEFAULT TRUE
);

CREATE TABLE test_table2 (
    id SERIAL PRIMARY KEY,
    value DECIMAL(10, 2),
    category TEXT,
    FOREIGN KEY (category) REFERENCES test_category(category_id)
);

CREATE TABLE test_category (
    category_id INT PRIMARY KEY,
    category_name VARCHAR(50) UNIQUE NOT NULL
);

-- 插入测试数据
INSERT INTO test_table(name, age) 
VALUES ('Alice', 30), ('Bob', 25), ('Charlie', 40), ('David', NULL);

INSERT INTO test_category(category_id, category_name)
VALUES (1, 'Electronics'), (2, 'Clothing'), (3, 'Home');

-- 测试边界条件和复杂查询
SELECT * FROM test_table WHERE age = 0;
SELECT name FROM test_table WHERE is_active = FALSE;

SELECT t.*, c.category_name 
FROM test_table t 
JOIN test_category c ON t.id = c.category_id 
WHERE t.age > 18 AND (c.category_name LIKE 'E%' OR c.category_name LIKE 'H%');

-- 测试异常和错误条件
INSERT INTO test_table(name, age) VALUES ('ErrorTest', -1);
INSERT INTO test_category(category_id, category_name) VALUES (4, 'InvalidCategory');