CREATE TABLE v3 (v1 INTEGER PRIMARY KEY, v2 REAL, v3 TEXT UNIQUE);
CREATE TEMP VIEW v_view2 AS SELECT v1, COUNT(v2) AS total FROM v3 GROUP BY v1 HAVING total > 0;
CREATE TRIGGER trg4 BEFORE INSERT ON v3 BEGIN 
    UPDATE v3 SET v2 = (SELECT MAX(v2) FROM v3) WHERE v1 = NEW.v1;
END;
INSERT INTO v3 (v1, v2, v3) VALUES (1, 1.0, 'unique1'), (2, 2.0, 'unique2');
SELECT * FROM v_view2 WHERE total = (SELECT COUNT(*) FROM v3);
